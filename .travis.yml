sudo: false
language: ruby
cache: bundler
rvm:
  - 2.5
  - 2.6
env:
  - DB=mysql
  - DB=sqlite
  - DB=postgresql
gemfile:
  - gemfiles/Gemfile.rails-5.0-stable
  - gemfiles/Gemfile.rails-5.1-stable
  - gemfiles/Gemfile.rails-5.2-stable
  - gemfiles/Gemfile.rails-6.0-stable
  - Gemfile
services:
  - postgresql
  - mysql
before_script:
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build
script:
  - export RAILS_ENV=test
  - bundle exec rake app:db:create app:db:migrate
  - bundle exec rspec spec
after_script:
  - ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT
addons:
  code_climate:
    repo_token:
      secure: "UMX9qWam4bFUsJSqjFMPTSxEb5IhChT7XyEpOvMRNitOBt/vel2BNlJHWsJI7eB51SMcsdE5dKgnB465qYYO8VS5Fhw9ro3EeBT6daceRBjgpb2RUIHefiGlbYqlBDILBkolImQuQb57FEHP7fZu59dF98p0ApRepvlE2nQQ7mYe4qcSoNll/ufmeMsKPhtgHo+XTSZXrCSMqv6UC1nquP75o5AIvBoYpvS9wbk3GaaII2S90I7Nrxp0ocHXxV/Ws8GgkUPnJjv5vYaP7C2E3M3eocdie7OoMjhFMc6efsFISkX8RfcZ/McB4ivfYQazojIZ00N+47yIOz/YHpyHfH7xuo6Yeh+obpLhhXL8dLs+6yQwOiq0t7yLl2B4nKpZzQkN4S/IpUbJansUsZKS1sY8SUG2fX5Wif7hywx4aVOlQZJmzywIupoeh9IkBNPiSZ5I7VITlz/NeSWBciK8hpUr14eduGS0sZKNMi7cFYaQ4VMIATEZgRmdX9OmxztwYIOcYd3YNti5zz84nf+VCaKKBw7KCldM2F98W2xj7YPP2j0/iP+tOc6EKXLfloWUrSLM1CcxDy47zLNWjzspp0J1R8i52ZVqM7vfkD/P64TuZI7DvZHaeJGYp0gjUfNEREsCR9VdyXVcaGxQH9Zwv/T81ofFr3QS724kbB/E7cI="
